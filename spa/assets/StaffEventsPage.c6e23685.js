import{h as s,u as b,an as E,ao as k,_ as A,s as f,o as n,O as d,P as i,S as B,ap as h,c as v,Y as g,T as l,Q as C,V as _,W as I,Z as y}from"./index.23a141fd.js";import{d as p,a as Q}from"./use-model-toggle.81454eea.js";import{a as x}from"./QList.69e56486.js";import{Q as S}from"./QPage.32d3344f.js";import{S as T}from"./SmallDutyCard.35fb3f09.js";import"./use-dark.477b7fb1.js";import"./QChip.c1a39239.js";import"./QCard.9f53c50a.js";import"./QCardActions.f11e2357.js";import"./QExpansionItem.68212f34.js";const M=[s("g",{transform:"matrix(1 0 0 -1 0 80)"},[s("rect",{width:"10",height:"20",rx:"3"},[s("animate",{attributeName:"height",begin:"0s",dur:"4.3s",values:"20;45;57;80;64;32;66;45;64;23;66;13;64;56;34;34;2;23;76;79;20",calcMode:"linear",repeatCount:"indefinite"})]),s("rect",{x:"15",width:"10",height:"80",rx:"3"},[s("animate",{attributeName:"height",begin:"0s",dur:"2s",values:"80;55;33;5;75;23;73;33;12;14;60;80",calcMode:"linear",repeatCount:"indefinite"})]),s("rect",{x:"30",width:"10",height:"50",rx:"3"},[s("animate",{attributeName:"height",begin:"0s",dur:"1.4s",values:"50;34;78;23;56;23;34;76;80;54;21;50",calcMode:"linear",repeatCount:"indefinite"})]),s("rect",{x:"45",width:"10",height:"30",rx:"3"},[s("animate",{attributeName:"height",begin:"0s",dur:"2s",values:"30;45;13;80;56;72;45;76;34;23;67;30",calcMode:"linear",repeatCount:"indefinite"})])])];var N=b({name:"QSpinnerAudio",props:E,setup(a){const{cSize:t,classes:e}=k(a);return()=>s("svg",{class:e.value,fill:"currentColor",width:t.value,height:t.value,viewBox:"0 0 55 80",xmlns:"http://www.w3.org/2000/svg"},M)}});const w=function(a){const t=new Date(a),e=t.getMonth();return t.getDate()+" / "+e};const L={components:{SmallDutyCard:T},data(){return{isLoading:!0,staffMap:[],eventsArray:[]}},computed:{currentTerm(){return f.getters.getCurrentTerm},events(){let t=f.getters.getEvents.filter(e=>e.term===this.currentTerm.term&&e.year===this.currentTerm.year);return t.sort((e,o)=>{const r=["Shell","Remove","Hundred","6th Form"];return r.indexOf(e.year_group)-r.indexOf(o.year_group)}),t},dates(){return f.getters.getFullDates.filter(e=>e.term===this.currentTerm.term&&e.year===this.currentTerm.year)}},mounted(){console.log("mounting staffEventsPage"),this.getStaffByEventId(),console.log(w("2022-02-02")),this.putEventsInAnArrayByDate()},methods:{update(){this.getStaffByEventId()},async getStaffByEventId(){this.isLoading=!0;const a=this.events;for(const t of a){let e=await fetch(f.getters.getServerURL+`api/v1/public/events/${t.event_id}/loading`);e.ok||console.error("failed to load staff for event ",t.id," from database. ",e.message);const r=(await e.json()).map(c=>c.initials);this.staffMap[t.event_id]=r}this.isLoading=!1},formatDate(a){return w(a)},putEventsInAnArrayByDate(){for(let a in this.dates){let t=this.events.filter(o=>o.date_id===this.dates[a].date_id);const e={...this.dates[a],events:t};this.eventsArray.push(e)}}}},P={class:"content",style:{"max-width":"700px"}},O={class:"row items-center"};function V(a,t,e,o,r,c){const D=B("small-duty-card");return r.isLoading?(n(),d(S,{key:1,class:"flex flex-center"},{default:i(()=>[l(N,{size:"lg"})]),_:1})):(n(),d(S,{key:0,class:"q-pa-sm q-ma-sm flex flex-center"},{default:i(()=>[h("div",P,[(n(!0),v(y,null,g(r.eventsArray,u=>(n(),d(x,{key:u.event_id,bordered:"",separator:""},{default:i(()=>[l(Q,{dense:""},{default:i(()=>[l(p,{side:"",style:{"min-width":"100px"},class:"flex-center"},{default:i(()=>[h("div",O,[l(C,{name:"event",size:"sm",class:"q-pr-md"}),_(" "+I(c.formatDate(u.date)),1)])]),_:2},1024),u.events.length>0?(n(),d(p,{key:0},{default:i(()=>[l(x,{separator:""},{default:i(()=>[(n(!0),v(y,null,g(u.events,m=>(n(),d(D,{key:m.event_id,event_details:m,staff:r.staffMap[m.event_id],onUpdate:c.update},null,8,["event_details","staff","onUpdate"]))),128))]),_:2},1024)]),_:2},1024)):(n(),d(p,{key:1},{default:i(()=>[_(" No events have been added for this date")]),_:1}))]),_:2},1024)]),_:2},1024))),128))])]),_:1}))}var G=A(L,[["render",V],["__scopeId","data-v-7b2aa86a"]]);export{G as default};
