import{S as H,Q as L}from"./StaffDatePage.82180a7f.js";import{Q as K}from"./QTabs.116bdff8.js";import{a as z}from"./QResizeObserver.f018ac11.js";import{Q as P}from"./QPage.6d7018ef.js";import{c as J,s as X,t as G,e as Z,Q as D,g as V,R as W}from"./QBtn.68a98313.js";import{a as $,g as A,Q as ee,c as F}from"./focusout.15c52526.js";import{Q as I,a as S,b as te}from"./QCard.12db0225.js";import{s as c}from"./staffing.1c48af4b.js";import{_ as T,o as f,c as p,a7 as t,B as Q,aa as O,C as x,y as _,v as y,x as i,F as g,D as w,r as le,a8 as N,a9 as R,E as h,ac as B,d as ae,h as re,z as n,A as Y}from"./index.fc2873ca.js";import{B as ne}from"./BaseCard.c5617a1e.js";import{Q as k}from"./QSelect.ee834073.js";import{Q as E}from"./QInput.ab74723d.js";import{Q as q}from"./QDialog.abb71ef4.js";import{C}from"./ClosePopup.ab6692f3.js";import"./DutyCard.81142f58.js";import"./uid.42677368.js";import"./scroll.c7156d1f.js";import"./rtl.b51694b1.js";import"./focus-manager.e17a04ac.js";import"./QScrollObserver.afc3a607.js";import"./QMenu.c868487e.js";import"./prevent-scroll.b6fc537e.js";const se={props:{modelValue:{},label:{required:!0,type:Number},member:{required:!1},isEditable:{type:Boolean,required:!0}},emits:["update:modelValue","update-array"],methods:{submitData(){this.$emit("update:modelValue",this.$refs.staffname.value),this.$emit("update-array")},warnMessage(){this.isWarning=!0},clickOK(){this.isWarning=!1,document.getElementById(this.member).focus()}},data(){return{isWarning:!1}}},oe={for:"staffname"},ue=["id"],de={key:1},ie=["id","value"];function fe(r,e,o,v,l,s){return f(),p("div",null,[t("label",oe,Q(o.label),1),o.member?o.member&&!o.isEditable?(f(),p("span",de,Q(o.member),1)):o.member&&o.isEditable?(f(),p("input",{key:2,id:o.member,value:o.member,ref:"staffname",onClick:e[2]||(e[2]=(...m)=>s.warnMessage&&s.warnMessage(...m)),onBlur:e[3]||(e[3]=(...m)=>s.submitData&&s.submitData(...m)),onKeyup:e[4]||(e[4]=O(m=>m.target.blur(),["enter"]))},null,40,ie)):x("",!0):(f(),p("input",{key:0,id:o.member,ref:"staffname",onBlur:e[0]||(e[0]=(...m)=>s.submitData&&s.submitData(...m)),onKeyup:e[1]||(e[1]=O(m=>m.target.blur(),["enter"]))},null,40,ue))])}var j=T(se,[["render",fe],["__scopeId","data-v-5138bcbb"]]);const me={mounted(){this.staffArray=this.staff},data(){return{staffArray:[],isEditable:!1}},components:{SltStaffInput:j,BaseCard:ne},props:{id:{type:String,required:!0},yeargroup:{type:String,required:!0},title:{type:String,required:!0},location:{type:String,required:!0},staff:{type:Array,required:!0},date:{type:String,required:!0}},methods:{updateStaff(){console.log("DutyCard says: "),console.log(this.staffArray),console.log(this.id,this.$refs.yeargroup.value,this.$refs.title.value,this.$refs.location.value);const r={title:this.$refs.title.value,location:this.$refs.location.value,yeargroup:this.$refs.yeargroup.value,id:this.id,staff:this.staffArray};c.dispatch("updateStaff",r),this.isEditable=!1},addStaff(){this.staffArray.push(0)},removeStaff(){this.staffArray.splice(this.staffArray.length-1,1)},removeFromDatabase(){console.log("Editable Date Card is deleting ",this.id," from the database. Title: ",this.title),c.dispatch("removeEvent",this.id)}}},ce=r=>(N("data-v-28180610"),r=r(),R(),r),pe=["value"],ve=ce(()=>t("datalist",{id:"event"},[t("option",{value:"Shell"},"Shell"),t("option",{value:"Remove"},"Remove"),t("option",{value:"Hundred"},"Hundred"),t("option",{value:"6th Form"},"6th Form")],-1)),he=["id","value"],_e=["id","value"],ye={class:"infopanel"},ge={class:"button-holder"};function be(r,e,o,v,l,s){const m=_("slt-staff-input"),u=_("base-card");return f(),y(u,{styleType:o.yeargroup},{default:i(()=>[t("button",{class:"cancel-button",onClick:e[0]||(e[0]=(...a)=>s.removeFromDatabase&&s.removeFromDatabase(...a))},"X"),t("header",null,[t("p",null,Q(o.date),1),t("input",{list:"event",ref:"yeargroup",value:o.yeargroup,onChange:e[1]||(e[1]=(...a)=>s.updateStaff&&s.updateStaff(...a))},null,40,pe),ve,t("input",{class:"input-h2",type:"text",id:o.title,value:o.title,ref:"title",onBlur:e[2]||(e[2]=(...a)=>s.updateStaff&&s.updateStaff(...a))},null,40,he),t("input",{class:"input-h3",type:"text",id:o.location,value:o.location,ref:"location",onBlur:e[3]||(e[3]=(...a)=>s.updateStaff&&s.updateStaff(...a))},null,40,_e)]),t("div",ye,[(f(!0),p(g,null,w(l.staffArray,(a,d)=>(f(),y(m,{key:a,member:a,label:d+1,modelValue:l.staffArray[d],"onUpdate:modelValue":U=>l.staffArray[d]=U,isEditable:!0,onUpdateArray:s.updateStaff},null,8,["member","label","modelValue","onUpdate:modelValue","onUpdateArray"]))),128))]),t("div",ge,[le(r.$slots,"default",{onClick:e[4]||(e[4]=(...a)=>s.updateStaff&&s.updateStaff(...a))},void 0,!0),t("button",{onClick:e[5]||(e[5]=(...a)=>s.addStaff&&s.addStaff(...a))},"Add Staff"),t("button",{onClick:e[6]||(e[6]=(...a)=>s.removeStaff&&s.removeStaff(...a))},"Remove Staff")])]),_:3},8,["styleType"])}var we=T(me,[["render",be],["__scopeId","data-v-28180610"]]);const Se={mounted(){this.staffArray=Array.from(this.staff)},computed:{currentTerm(){return c.getters.getCurrentTerm}},data(){return{staffArray:[],isEditable:!1,year:"",location:"",title:""}},components:{SltStaffInput:j},props:{staff:{type:Array,required:!0},date:{type:String,required:!0}},methods:{addEvent(){fetch("https://wheatyfirstdatabase-default-rtdb.europe-west1.firebasedatabase.app/staff.json",{method:"POST",body:JSON.stringify({date:this.date,yeargroup:this.year,title:this.title,location:this.location,staff:this.staffArray,term:this.currentTerm})}).then(r=>{if(r.ok)return r.json()}).then(r=>{let e=Array.from(this.staffArray),o={id:r.name,yeargroup:this.year,title:this.title,location:this.location,staff:e,date:this.date,term:this.currentTerm};console.log(o),c.dispatch("addEvent",o),this.year=null,this.title=null,this.location=null})},addStaff(){this.staffArray.push(0)},removeStaff(){this.staffArray.splice(this.staffArray.length-1,1)}}},Ee=r=>(N("data-v-734ee29d"),r=r(),R(),r),Te=Ee(()=>t("datalist",{id:"event"},[t("option",{value:"Shell"},"Shell"),t("option",{value:"Remove"},"Remove"),t("option",{value:"Hundred"},"Hundred"),t("option",{value:"6th Form"},"6th Form")],-1)),Ve={class:"infopanel"},Ce={class:"button-holder"};function Ae(r,e,o,v,l,s){const m=_("slt-staff-input"),u=_("base-card");return f(),y(u,{styleType:l.year},{default:i(()=>[t("header",null,[h(t("input",{list:"event",ref:"yeargroup",placeholder:"Year","onUpdate:modelValue":e[0]||(e[0]=a=>l.year=a)},null,512),[[B,l.year]]),Te,h(t("input",{class:"input-h2",type:"text",id:"title",placeholder:"Title",ref:"title","onUpdate:modelValue":e[1]||(e[1]=a=>l.title=a)},null,512),[[B,l.title]]),h(t("input",{class:"input-h3",type:"text",id:"location",placeholder:"Location",ref:"location","onUpdate:modelValue":e[2]||(e[2]=a=>l.location=a)},null,512),[[B,l.location]])]),t("div",Ve,[(f(!0),p(g,null,w(l.staffArray,(a,d)=>(f(),y(m,{key:a,member:a,label:d+1,modelValue:l.staffArray[d],"onUpdate:modelValue":U=>l.staffArray[d]=U,isEditable:!0},null,8,["member","label","modelValue","onUpdate:modelValue"]))),128))]),t("div",Ce,[t("button",{onClick:e[3]||(e[3]=(...a)=>s.addEvent&&s.addEvent(...a))},"Add Event"),t("button",{onClick:e[4]||(e[4]=(...a)=>s.addStaff&&s.addStaff(...a))},"Add Staff"),t("button",{onClick:e[5]||(e[5]=(...a)=>s.removeStaff&&s.removeStaff(...a))},"Remove Staff")])]),_:1},8,["styleType"])}var ke=T(Se,[["render",Ae],["__scopeId","data-v-734ee29d"]]),M=J({name:"QCardActions",props:{...X,vertical:Boolean},setup(r,{slots:e}){const o=G(r),v=ae(()=>`q-card__actions ${o.value} q-card__actions--${r.vertical===!0?"vert column":"horiz row"}`);return()=>re("div",{class:v.value},Z(e.default))}});const De={created(){console.log("mounting array"),this.newEvents=Array.from(this.events),console.log(this.newEvents)},computed:{events(){const r=c.getters.getCurrentTerm;return c.getters.getEvents.filter(v=>v.term===r)},dates(){const r=c.getters.getDates,e=c.getters.getCurrentTerm;return r.filter(v=>v.term===e)[0].dates},currentTerm(){return c.getters.getCurrentTerm}},data(){return{newEvents:[],yeargroupOptions:["Shell","Remove","Hundred","6th Form"],newDate:null,newTitle:null,newLocation:null,newYeargroup:null,staffNum:null,newStaff:[null,null,null,null],valRules:[r=>!!r||"Required"],confirm:!1,allowSubmit:!1,missingData:!1,deleteId:null,deletePopup:!1}},watch:{events(){this.newEvents=this.events}},methods:{deleteEvent(){console.log("delete triggered on ",this.deleteId),c.dispatch("removeEvent",this.deleteId),this.deleteId=null,this.newEvents=c.getters.getEvents},setValue(r){console.log("altering ",r),console.log(this.newEvents)},submit(){this.confirm=!0},addEvent(){if(this.newDate&&this.newTitle&&this.newLocation&&this.newYeargroup&&this.staffNum){const r=Array(this.staffNum).fill(0);fetch("https://wheatyfirstdatabase-default-rtdb.europe-west1.firebasedatabase.app/staff.json",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:this.newDate,yeargroup:this.newYeargroup,title:this.newTitle,location:this.newLocation,staff:r,term:this.currentTerm})}).then(e=>{if(e.ok)return e.json()}).then(e=>{let o={id:e.name,yeargroup:this.newYeargroup,title:this.newTitle,location:this.newLocation,staff:r,date:this.newDate,term:this.currentTerm};console.log(o),c.dispatch("addEvent",o),this.newDate=null,this.newYeargroup=null,this.newTitle=null,this.newLocation=null,this.staffNum=null,this.newEvents=c.getters.getEvents})}else this.missingData=!0},addStaff(){this.newStaff.push(null)},removeStaff(){this.newStaff.splice(this.newStaff.length-1,1)},triggerDelete(r){this.deleteId=r,this.deletePopup=!0},testMethod(){const r=c.getters.getCurrentTerm;console.log("current term = ",r);const e=c.getters.getEvents;console.log("allEvents = ",e);const o=e.filter(v=>v.term===r);return console.log("currentEvents = ",o),o}}},b=r=>(N("data-v-c006b70c"),r=r(),R(),r),Qe={class:"q-table",id:"events"},Ue=b(()=>t("tr",null,[t("th",null,"Date"),t("th",null,"Year"),t("th",null,"Event"),t("th",null,"Location"),t("th",{colspan:"4"},"Staff")],-1)),Ie=["colspan"],Be=["onClick"],qe=b(()=>t("tr",null,[t("td",{colspan:"9"})],-1)),xe={colspan:4},Ne=b(()=>t("div",{class:"text-h6"},"Create Event",-1)),Re=b(()=>t("div",{class:"q-pt-none"},"Are you sure you want to create this event?",-1)),Le=b(()=>t("div",{class:"text-h6"},"Warning",-1)),Pe=b(()=>t("div",{class:"q-pt-none"}," All fields must be filled in order to add an event. ",-1)),We=b(()=>t("div",{class:"text-h6"},"Delete",-1)),Fe=b(()=>t("div",{class:"q-pt-none"},"Are you sure you want to delete this event?",-1));function Oe(r,e,o,v,l,s){const m=_("q-card-action");return f(),p(g,null,[t("table",Qe,[Ue,(f(!0),p(g,null,w(l.newEvents,(u,a)=>(f(),p("tr",{key:u.id},[t("td",null,[n(k,{options:s.dates,placeholder:u.date,dense:"",ref_for:!0,ref:u.id+"date",modelValue:l.newEvents[a].date,"onUpdate:modelValue":d=>l.newEvents[a].date=d,onBlur:d=>s.setValue(u.id)},null,8,["options","placeholder","modelValue","onUpdate:modelValue","onBlur"])]),t("td",null,[n(k,{options:l.yeargroupOptions,modelValue:l.newEvents[a].yeargroup,"onUpdate:modelValue":d=>l.newEvents[a].yeargroup=d,placeholder:u.yeargroup,style:{width:"5rem"},dense:"",onBlur:d=>s.setValue(u.id)},null,8,["options","modelValue","onUpdate:modelValue","placeholder","onBlur"])]),t("td",null,[n(E,{type:"text",placeholder:u.title,dense:"",modelValue:l.newEvents[a].title,"onUpdate:modelValue":d=>l.newEvents[a].title=d,onBlur:d=>s.setValue(u.id)},null,8,["placeholder","modelValue","onUpdate:modelValue","onBlur"])]),t("td",null,[n(E,{type:"text",placeholder:u.location,dense:"",modelValue:l.newEvents[a].location,"onUpdate:modelValue":d=>l.newEvents[a].location=d,onBlur:d=>s.setValue(u.id)},null,8,["placeholder","modelValue","onUpdate:modelValue","onBlur"])]),(f(!0),p(g,null,w(u.staff,d=>(f(),p("td",{key:u.id+d,colspan:4/u.staff.length},[n(E,{placeholder:d,style:{width:"2rem"},dense:""},null,8,["placeholder"])],8,Ie))),128)),t("td",{onClick:d=>s.triggerDelete(u.id)},[n(D,{name:"delete"})],8,Be)]))),128)),qe,t("tr",null,[t("td",null,[n(k,{options:s.dates,modelValue:l.newDate,"onUpdate:modelValue":e[0]||(e[0]=u=>l.newDate=u),dense:"",rules:l.valRules},null,8,["options","modelValue","rules"])]),t("td",null,[n(k,{options:l.yeargroupOptions,modelValue:l.newYeargroup,"onUpdate:modelValue":e[1]||(e[1]=u=>l.newYeargroup=u),dense:"",rules:l.valRules},null,8,["options","modelValue","rules"])]),t("td",null,[n(E,{label:"Title",modelValue:l.newTitle,"onUpdate:modelValue":e[2]||(e[2]=u=>l.newTitle=u),dense:"",rules:l.valRules},null,8,["modelValue","rules"])]),t("td",null,[n(E,{label:"Location",modelValue:l.newLocation,"onUpdate:modelValue":e[3]||(e[3]=u=>l.newLocation=u),dense:"",rules:l.valRules},null,8,["modelValue","rules"])]),t("td",xe,[n(E,{type:"number",label:"Number of Staff",modelValue:l.staffNum,"onUpdate:modelValue":e[4]||(e[4]=u=>l.staffNum=u),modelModifiers:{number:!0},dense:"",rules:l.valRules},null,8,["modelValue","rules"])]),t("td",null,[n(D,{onClick:s.addEvent,name:"add"},null,8,["onClick"])])])]),n(q,{modelValue:l.confirm,"onUpdate:modelValue":e[5]||(e[5]=u=>l.confirm=u)},{default:i(()=>[n(I,null,{default:i(()=>[n(S,null,{default:i(()=>[Ne]),_:1}),n(S,null,{default:i(()=>[Re]),_:1}),n(M,null,{default:i(()=>[h(n(V,{flat:"",label:"OK",color:"positive",onClick:s.addEvent},null,8,["onClick"]),[[C]]),h(n(V,{flat:"",label:"cancel",color:"negative"},null,512),[[C]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(q,{modelValue:l.missingData,"onUpdate:modelValue":e[6]||(e[6]=u=>l.missingData=u)},{default:i(()=>[n(I,null,{default:i(()=>[n(S,null,{default:i(()=>[Le]),_:1}),n(S,null,{default:i(()=>[Pe]),_:1}),n(M,null,{default:i(()=>[h(n(V,{flat:"",label:"ok",color:"primary"},null,512),[[C]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),n(q,{modelValue:l.deletePopup,"onUpdate:modelValue":e[8]||(e[8]=u=>l.deletePopup=u)},{default:i(()=>[n(I,null,{default:i(()=>[n(S,null,{default:i(()=>[We]),_:1}),n(S,null,{default:i(()=>[Fe]),_:1}),n(m,null,{default:i(()=>[h(n(V,{flat:"",label:"ok",color:"positive",onClick:e[7]||(e[7]=u=>s.deleteEvent(this.deleteId))},null,512),[[C]]),h(n(V,{flat:"",label:"cancel",color:"negative"},null,512),[[C]])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var Ye=T(De,[["render",Oe],["__scopeId","data-v-c006b70c"]]);const Me={data(){return{newStaff:[0,0]}},computed:{eventArray(){return c.getters.getEvents},thisDateEvents(){return this.eventArray.filter(e=>e.date===this.date)},events(){return c.getters.getEvents}},props:{date:{type:String,required:!0}},components:{EditableDutyCard:we,NewEventCard:ke,MagicTable:Ye}},je={class:"datepage"};function He(r,e,o,v,l,s){const m=_("new-event-card"),u=_("editable-duty-card"),a=_("magic-table");return f(),p("div",je,[o.date!=="Whole Term"?(f(),y(m,{key:0,staff:l.newStaff,date:o.date},null,8,["staff","date"])):x("",!0),(f(!0),p(g,null,w(s.thisDateEvents,d=>(f(),y(u,{id:d.id,key:d.title+d.date,yeargroup:d.yeargroup,title:d.title,location:d.location,staff:d.staff,date:d.date},null,8,["id","yeargroup","title","location","staff","date"]))),128)),o.date==="Whole Term"?(f(),y(a,{key:1})):x("",!0)])}var Ke=T(Me,[["render",He],["__scopeId","data-v-540c37a8"]]);const ze={components:{StaffDatePage:H,EditableDatePage:Ke},computed:{dates(){const r=c.getters.getDates,e=c.getters.getCurrentTerm;return r.filter(v=>v.term===e)[0].dates}},data(){return{selectedTab:"Whole Term",rightDrawerState:!0}},methods:{selectTab(r){this.selectedTab=r}}},Je={class:"sidebar col-2 desktop-only"};function Xe(r,e,o,v,l,s){const m=_("staff-date-page"),u=_("editable-date-page");return f(),p(g,null,[n(P,{class:"mobile-only"},{default:i(()=>[n(z,{class:"bg-secondary text-white shadow-2"},{default:i(()=>[n(K,{shrink:"",modelValue:l.selectedTab,"onUpdate:modelValue":e[0]||(e[0]=a=>l.selectedTab=a)},{default:i(()=>[n(L,{name:"Whole Term",label:"whole-term",key:"wholeTerm"}),(f(!0),p(g,null,w(s.dates,a=>(f(),y(L,{name:a,label:a,key:a},null,8,["name","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),n(m,{date:l.selectedTab},null,8,["date"])]),_:1}),n(P,{class:"row no-wrap desktop-only"},{default:i(()=>[t("div",Je,[n(te,{class:"fit"},{default:i(()=>[n($,{padding:"",class:"menu-list"},{default:i(()=>[h((f(),y(F,{clickable:"",key:"Whole Term",active:this.selectedTab==="Whole Term",onClick:e[1]||(e[1]=a=>s.selectTab("Whole Term"))},{default:i(()=>[n(A,{avatar:""},{default:i(()=>[n(D,{name:"calendar_month"})]),_:1}),n(ee),n(A,null,{default:i(()=>[Y(" Whole Term")]),_:1})]),_:1},8,["active"])),[[W]]),(f(!0),p(g,null,w(s.dates,a=>h((f(),y(F,{key:a,clickable:"",active:this.selectedTab===a,onClick:d=>s.selectTab(a)},{default:i(()=>[n(A,{avatar:""},{default:i(()=>[n(D,{name:"event"})]),_:1}),n(A,null,{default:i(()=>[Y(Q(a),1)]),_:2},1024)]),_:2},1032,["active","onClick"])),[[W]])),128))]),_:1})]),_:1})]),n(u,{date:l.selectedTab},null,8,["date"])]),_:1})],64)}var gt=T(ze,[["render",Xe],["__scopeId","data-v-42bcc1f4"]]);export{gt as default};
