import{d as y}from"./use-model-toggle.59bd39dc.js";import{a as w}from"./QList.5fcd14f4.js";import{Q as k}from"./QPage.ecc8860c.js";import{h as a,u as b,an as M,ao as x,_ as C,s as p,o as s,O as l,P as i,S as h,T as f,c as m,Y as v,V as E,Z as g,ap as L}from"./index.68a7ba35.js";import{S as P}from"./SmallDutyCard.c43c781c.js";import"./use-dark.d374fe27.js";import"./QChip.63e82713.js";import"./QCard.c4c9127e.js";import"./QCardActions.64780dae.js";import"./QExpansionItem.d2e2788c.js";const B=[a("g",{fill:"none","fill-rule":"evenodd","stroke-width":"2"},[a("circle",{cx:"22",cy:"22",r:"1"},[a("animate",{attributeName:"r",begin:"0s",dur:"1.8s",values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),a("animate",{attributeName:"stroke-opacity",begin:"0s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})]),a("circle",{cx:"22",cy:"22",r:"1"},[a("animate",{attributeName:"r",begin:"-0.9s",dur:"1.8s",values:"1; 20",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.165, 0.84, 0.44, 1",repeatCount:"indefinite"}),a("animate",{attributeName:"stroke-opacity",begin:"-0.9s",dur:"1.8s",values:"1; 0",calcMode:"spline",keyTimes:"0; 1",keySplines:"0.3, 0.61, 0.355, 1",repeatCount:"indefinite"})])])];var N=b({name:"QSpinnerPuff",props:M,setup(n){const{cSize:e,classes:t}=x(n);return()=>a("svg",{class:t.value,stroke:"currentColor",width:e.value,height:e.value,viewBox:"0 0 44 44",xmlns:"http://www.w3.org/2000/svg"},B)}});const Q={mounted(){console.log("staffDatePage was mounted"),this.getStaffByEventId()},components:{SmallDutyCard:P},data(){return{isLoading:!0,staffMap:[]}},computed:{events(){return p.getters.getEvents.filter(t=>t.date_id===this.date_id)},allEvents(){return p.getters.getEvents}},props:{date_id:{type:String,required:!0}},methods:{async getStaffByEventId(){console.log("StaffDatePage is getting staff for all events: ",this.events),this.isLoading=!0;const n=this.allEvents;for(const e of n){let t=await fetch(p.getters.getServerURL+`api/v1/public/events/${e.event_id}/loading`);t.ok||console.error("failed to load staff for event ",e.id," from database. ",t.message);let u=await t.json();console.log("data = ",u);const r=u.map(d=>d.initials);this.staffMap[e.event_id]=r}console.log("staffMap",this.staffMap),this.isLoading=!1}}},T=L("p",null,"Loading",-1);function D(n,e,t,u,r,d){const _=h("small-duty-card"),S=h("q-list-item");return r.isLoading?(s(),l(k,{key:1},{default:i(()=>[T,f(N,{color:"primary",size:"3em"})]),_:1})):(s(),l(k,{key:0,class:"row",style:{"align-items":"flex-start"}},{default:i(()=>[f(w,null,{default:i(()=>[(s(!0),m(g,null,v(n.dates,o=>(s(),l(S,{key:o.date_id},{default:i(()=>[f(y,null,{default:i(()=>[E(" date ")]),_:1}),f(y,null,{default:i(()=>[(s(!0),m(g,null,v(d.events,c=>(s(),l(_,{key:c.event_id,event_details:c,staff:r.staffMap[c.event_id]},null,8,["event_details","staff"]))),128))]),_:1})]),_:2},1024))),128))]),_:1}),(s(!0),m(g,null,v(d.events,o=>(s(),l(_,{key:o.event_id,event_details:o,staff:r.staffMap[o.event_id]},null,8,["event_details","staff"]))),128))]),_:1}))}var Y=C(Q,[["render",D]]);export{Y as default};
